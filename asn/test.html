<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <script src="../trustedJS.js"></script>
        <script src="./asn.js"></script>
        <script src="../pki/src/schemas/pkcs12.js"></script>
        <script src="../pki/src/schemas/pkcs7.js"></script>
        <script src="../pki/src/schemas/rfc5280.js"></script>
    </head>
    <body>
        <div>TODO write content</div>
        <script>
            //PFX
            //30820C5802010330820C1406092A864886F70D010701A0820C0504820C0130820BFD3082037606092A864886F70D010701A0820367048203633082035F3082035B060B2A864886F70D010C0A0102A08202B6308202B2301C060A2A864886F70D010C0103300E04085343835212293379020207D004820290BABB026ED9CD1C3928563B5270CCEC68A2806575D11A16EE1BAC906F6D4957959F177392162BCDB59460CF6742F6A819A81939FD1ADB217AF4CA4FCCB0C580AFA6FBFC310958E342A059BB9EC50C38E386EE6B5D98178B451D7120C11BDFA073B4DF18C3D45A77FEA48C4CF76FD3CD02AD2FBCE6D16A53DF57BFB73C23E89D843390E1171744AFD4F3A774EF02EED0A336FA639FB0B24D088193B31B811EB6D15E5014D6C798442E37B01F0CED1A637D0256A0F064F5F0F74E2366A9E430CBD90DA0212CFE583CB2CABA1E6F598157E5B23C7EA8DA017E346E64118F4B6D8B4423400185F49F91072BD54BF8D4CFC6C1BBFEE22DBEA780AEA8FC46581970EEE55A61D8E74B49236EE15F9587ED355D421E731802F5DAD5354E0AEBB72F39A6750AA881090A036680AEC3BCAD4805F2621647D45D6CCA784094B9479090DF778217BDC35F8F0A6226C096E9FD89981D84000EB54AE57E8979831F76C13C071DE8DB9CE0D3681939D610F5356845286FD97C9D15678795E53505D2D2AD4F281336CDFE8C338AEB2A4155218F0A2FC754F61A31BCA19FD936490B8699C89A18861A6322A161CFF8BDCFF1D386FFBFB80674D659E275E16FD0D4BB7ADF09EDDD84E86D95545C92A76AB33A1B0CCE2AA44DED8171F46878009D05FE5677F5F20817EDDB9946356BA4840CA98314499B028AAB748A9003E163046D416E8BDE1DA234337E71CD752BA6C5B844EB89E6F03208FA71FBE3E6C0104B23098ED57EF830C798693319AE8E1C139C1622C855CC44F94773CEEBA2B5FBC57C4D958BE16D57E4D62ECDB79C411CF1B9093643A049C85407A708458E6CFCA6C4646D6EA9EE9F487D961D0CD0CCCF9BBE443476FB4439BF1C8E61CB536181A5FBDC9E7DA9C4241BD2992A996C1FC1D1BFDB425804F5EE7BE1318191301306092A864886F70D0109153106040401000000301B06092A864886F70D010914310E1E0C007400650073007400300034305D06092B060104018237110131501E4E004D006900630072006F0073006F006600740020005300740072006F006E0067002000430072007900700074006F0067007200610070006800690063002000500072006F007600690064006500723082087F06092A864886F70D010706A08208703082086C0201003082086506092A864886F70D010701301C060A2A864886F70D010C0106300E040839B078F34E7ECD36020207D08082083827B3FCA11748FCA0B39B087416AE7723B99E45057EB9D0FA376B1DEBD38138277C202CF25F688EBBE58AF96DC872CB2E743B97A7EC8C621F04E6E66B39E4C2560FB3C80EEF3278F8388DA7389CEBC452E1DDC9001071D0E8D0720C4A733E172086A629A684A9DB7B134CDFB820B3CCC84CE3E48BB094DE5D4A7200D142604CDEC3469E507973FBC7DEB6F6D0BFA30589F0E4393D2C6B37A335F67978B30CEE7192D78A1976E9533478A93AF65888C0EC6612FB8C041868385602FE9965E0849613BE308DA7B272D16A2124D5594C7559C876BBAEA12ADC8DC2ACFAD6D7F5BA03F3CA0F5FFE4BFC6F5C71E78313F26EB7AA3E642E38C41928F54BF0A457EBE44B72D0DB717765CE5E96ED5272A7749C86626ED3496AD940E5758D70F7BEA5F20ED008CA77451005FBF5B97B363DD61C984F75D26254D491EE044516D1D528616250F401391A1FB2B2387695BDFD19C966EB3E35C966A6C2D2F0E18F5792084F249B49B1D68B96060DAC4B199F95A115C844A3B367E02E425F0F3BC870FAA0E36BC090DF0891AFE45598ABB7EEFAB6C6248459852B836A9A612E1DA4B46149CFF6B119B6964B983680E4F6849E981896A05EB4FE750ACFEF7DF39F5CC59B0839A556827D1A7E63606A271AE820E698262CA5CD25C6291420E3AE8586A959DCB4488924DE3121602E8129259B299F1767C38164CDB8565ECB5B7C4BBCD11058BB76CE1DFB19F87C4EE77218706C70D078AE680B769F474951EA36C0ACA074A4A893EAEF2C9B4DFE7673854D8F1C7A61408021C25FE732C10E0AA3434C81A293737E20754D7879074200492057DD49EA109D40BF74E526EC5F3B49E577571AF58E7F940868C49179924C1521FB34EF762E5A827550A71CBC39FB35AE059D32C7D28BE82D935C5BBA7556C51048D55819CD61A7FF404745636CFCED19A1DF199B9FCE4852049ADFFFA12EAB816E11773F118AA0D670B56689499C09FF824DB715DE99D8B9EFD0F17E42F868C80503C2FE7AB81D0D67CE4DBF4B6B5B51BB548AFE3C19CA17E1D6E47EF6F3FD359DDCCB5C25F1E9F76553171063E7949863EA9A25C3BD977CD5B60AEC04C727C29B6907BB9D8CD316DEDA89CE569D340C83356064E9D8378B0256D3734E304E0B052CB88C3468E0E0AE922E6D212A0E8DCC3E1D54D11B789756DE8B628099054E11D11BEB1244419BC62D1E167BD13F46C75324F702EFD711A38766271C661139A4842FC9B1527D8C78CC0E68664AF55931FB62B259796C0FA7BD40E2401CB561B9F86333E3EB42A2714D4D4502ADAEB6829A5BA1298DC5622D4BE30D47CC351F4802DEB4929BF673C3C8D2214F0135C1F84DCB8006A53FE30DEF1DB4705B5578313F0543CC2EB134CE9344D8C463DE6338C5D51D76E095C549AB7E07B5ECB50DE6F1621A6610E56D661565DE3579126C22EF6387B830FE87B079739A63C69866B046D33A5B3C621653A63D91FA066BE6B4B606842CA84B0FF1421ED77328CF28AB32D038164488B629535FBD09F16085526214482EB880DF182BD79924942C08F6D926E45F220ABB274D9D2BD2EC19596D407883F8C945412B7C046E9B6B47778E30E71FF5E6173739C256D48153A109D3E5C7D3631C8F012A18123CC481AA633324D2227EFB778D2EFECDABCD12EC9B7322202C301603FB34379FA8B9CF1E86F85C41194F82EFDC5405A9317625B863706886038CB03190915ABBBDE7113BFB0B99A24C4E24AAB108099F756A3DCE480FC1765F69DA50257E93E4486C8E78728387840BBE29C49D6BCDE59136A64B191CC9FDA31F181D8BB0F0D2CD3B7F08118B3387333E2AF9D819AA18DE8E65448BDB38BB0DBDC41EEA9E6D1650B50094DC08C9269E47A5BC7C3617359C66F0A6455BBB0240095E98649D2CB0C9C3CF5684750B4B079FBE20CF5CC52D254D05FE9929B42D8288F85AAE417480387A639035AA01EB50A0A4B943BCB813BFF3E4F4FDFCD6AB17AC39144D71F59ED93CCBC4637B5272BAF943EC17B83F6AC87F8DAF35E5116086B069BC04862FE4EB40EDBF54992BF6C939B69A5CF973DC43734B232E8A20ADD3A9FFF1DB7584C074AE1B40B3445DA3E59C1F7F97C646E8FE14E6DB8E3772F1720CB70DA70FB2CB9804CAE074AA5BFBF961353D0002A12A914651BD898792DB0C6ED46B8588336A8E10EF3F6EF5F86D5199B3C56F008A0E43113153223B91B4F8B6959543A0CC7C05E1AD5F3D0152D2D0A501F0B03B1A6B9C5F3A0C6BCE3BA85E6C50E48E30B696A05220737507B20BE661F9344D09825825450C36C5F1749D26CE5BD10CCBB54331702A672CB8F63D6DF055309A4A0281D73814A1F51BD9750891111AF978CDDFD833E8DFECEC4399E6E294821D1B85B6B15BDC7B091982F2FE8CA4B114237BE2EFA9AEB73C8088386FF3D98A1661CB33525BF0E7F53FFCD3B8602E8007C4CFA4E90F2710522DD992A40A0ACD8ED2262E1E15946AD0A56754830E6B8942A6A4BB8477AEF8F5A8AF6D600B12BE6712D4779FD0708B7C8D79709E389D4105B287A25C3810F46F39954F8B083B7A68818D026109C23F36B81DAE736652BA79578706530CD8584F097E6089CFE7395DEB512F7A28FFD66E6A1566022EE78027D240FBA0F3B9F865CBCE59B6A01F0770D254539EF17FAFDAC3AB745AA2D98969162D0237CAEDACB58F855F2A00587DC2980DB9F66C7AE798A13D38D850F240D714A13856B3DE70844DB8609581166454929CBDCC340CE6232BB2BCE6619DF7FC2C4890D40DA6D0143241D347DA4004371FDD0EA10AE3B2C206F3DCD1DFEABDD1EE56BCF52731A6E7AB1A2FEEACC60B158D3AAD4E7A0F6C5DCB781CC7669C7210E2BCABBDC0F66068DC2827632075C82966CD2E25B13E7C09CEB2754FF07D08D9A7728936AC78AD9F578FEE0B42E84E16E4DCF665F5465866BEF924505E2771F15C3E81E2FADA947BCC16B1F7C200DC8AF4B8993618F8303B301F300706052B0E03021A0414DB599DB4438665874FBC41EE53030366B425ACB004143FD475649B18567E78A1A7BA58F85C71FEE8B683020207D0
            var pfx = new trusted.Buffer("30820C5802010330820C1406092A864886F70D010701A0820C0504820C0130820BFD3082037606092A864886F70D010701A0820367048203633082035F3082035B060B2A864886F70D010C0A0102A08202B6308202B2301C060A2A864886F70D010C0103300E04085343835212293379020207D004820290BABB026ED9CD1C3928563B5270CCEC68A2806575D11A16EE1BAC906F6D4957959F177392162BCDB59460CF6742F6A819A81939FD1ADB217AF4CA4FCCB0C580AFA6FBFC310958E342A059BB9EC50C38E386EE6B5D98178B451D7120C11BDFA073B4DF18C3D45A77FEA48C4CF76FD3CD02AD2FBCE6D16A53DF57BFB73C23E89D843390E1171744AFD4F3A774EF02EED0A336FA639FB0B24D088193B31B811EB6D15E5014D6C798442E37B01F0CED1A637D0256A0F064F5F0F74E2366A9E430CBD90DA0212CFE583CB2CABA1E6F598157E5B23C7EA8DA017E346E64118F4B6D8B4423400185F49F91072BD54BF8D4CFC6C1BBFEE22DBEA780AEA8FC46581970EEE55A61D8E74B49236EE15F9587ED355D421E731802F5DAD5354E0AEBB72F39A6750AA881090A036680AEC3BCAD4805F2621647D45D6CCA784094B9479090DF778217BDC35F8F0A6226C096E9FD89981D84000EB54AE57E8979831F76C13C071DE8DB9CE0D3681939D610F5356845286FD97C9D15678795E53505D2D2AD4F281336CDFE8C338AEB2A4155218F0A2FC754F61A31BCA19FD936490B8699C89A18861A6322A161CFF8BDCFF1D386FFBFB80674D659E275E16FD0D4BB7ADF09EDDD84E86D95545C92A76AB33A1B0CCE2AA44DED8171F46878009D05FE5677F5F20817EDDB9946356BA4840CA98314499B028AAB748A9003E163046D416E8BDE1DA234337E71CD752BA6C5B844EB89E6F03208FA71FBE3E6C0104B23098ED57EF830C798693319AE8E1C139C1622C855CC44F94773CEEBA2B5FBC57C4D958BE16D57E4D62ECDB79C411CF1B9093643A049C85407A708458E6CFCA6C4646D6EA9EE9F487D961D0CD0CCCF9BBE443476FB4439BF1C8E61CB536181A5FBDC9E7DA9C4241BD2992A996C1FC1D1BFDB425804F5EE7BE1318191301306092A864886F70D0109153106040401000000301B06092A864886F70D010914310E1E0C007400650073007400300034305D06092B060104018237110131501E4E004D006900630072006F0073006F006600740020005300740072006F006E0067002000430072007900700074006F0067007200610070006800690063002000500072006F007600690064006500723082087F06092A864886F70D010706A08208703082086C0201003082086506092A864886F70D010701301C060A2A864886F70D010C0106300E040839B078F34E7ECD36020207D08082083827B3FCA11748FCA0B39B087416AE7723B99E45057EB9D0FA376B1DEBD38138277C202CF25F688EBBE58AF96DC872CB2E743B97A7EC8C621F04E6E66B39E4C2560FB3C80EEF3278F8388DA7389CEBC452E1DDC9001071D0E8D0720C4A733E172086A629A684A9DB7B134CDFB820B3CCC84CE3E48BB094DE5D4A7200D142604CDEC3469E507973FBC7DEB6F6D0BFA30589F0E4393D2C6B37A335F67978B30CEE7192D78A1976E9533478A93AF65888C0EC6612FB8C041868385602FE9965E0849613BE308DA7B272D16A2124D5594C7559C876BBAEA12ADC8DC2ACFAD6D7F5BA03F3CA0F5FFE4BFC6F5C71E78313F26EB7AA3E642E38C41928F54BF0A457EBE44B72D0DB717765CE5E96ED5272A7749C86626ED3496AD940E5758D70F7BEA5F20ED008CA77451005FBF5B97B363DD61C984F75D26254D491EE044516D1D528616250F401391A1FB2B2387695BDFD19C966EB3E35C966A6C2D2F0E18F5792084F249B49B1D68B96060DAC4B199F95A115C844A3B367E02E425F0F3BC870FAA0E36BC090DF0891AFE45598ABB7EEFAB6C6248459852B836A9A612E1DA4B46149CFF6B119B6964B983680E4F6849E981896A05EB4FE750ACFEF7DF39F5CC59B0839A556827D1A7E63606A271AE820E698262CA5CD25C6291420E3AE8586A959DCB4488924DE3121602E8129259B299F1767C38164CDB8565ECB5B7C4BBCD11058BB76CE1DFB19F87C4EE77218706C70D078AE680B769F474951EA36C0ACA074A4A893EAEF2C9B4DFE7673854D8F1C7A61408021C25FE732C10E0AA3434C81A293737E20754D7879074200492057DD49EA109D40BF74E526EC5F3B49E577571AF58E7F940868C49179924C1521FB34EF762E5A827550A71CBC39FB35AE059D32C7D28BE82D935C5BBA7556C51048D55819CD61A7FF404745636CFCED19A1DF199B9FCE4852049ADFFFA12EAB816E11773F118AA0D670B56689499C09FF824DB715DE99D8B9EFD0F17E42F868C80503C2FE7AB81D0D67CE4DBF4B6B5B51BB548AFE3C19CA17E1D6E47EF6F3FD359DDCCB5C25F1E9F76553171063E7949863EA9A25C3BD977CD5B60AEC04C727C29B6907BB9D8CD316DEDA89CE569D340C83356064E9D8378B0256D3734E304E0B052CB88C3468E0E0AE922E6D212A0E8DCC3E1D54D11B789756DE8B628099054E11D11BEB1244419BC62D1E167BD13F46C75324F702EFD711A38766271C661139A4842FC9B1527D8C78CC0E68664AF55931FB62B259796C0FA7BD40E2401CB561B9F86333E3EB42A2714D4D4502ADAEB6829A5BA1298DC5622D4BE30D47CC351F4802DEB4929BF673C3C8D2214F0135C1F84DCB8006A53FE30DEF1DB4705B5578313F0543CC2EB134CE9344D8C463DE6338C5D51D76E095C549AB7E07B5ECB50DE6F1621A6610E56D661565DE3579126C22EF6387B830FE87B079739A63C69866B046D33A5B3C621653A63D91FA066BE6B4B606842CA84B0FF1421ED77328CF28AB32D038164488B629535FBD09F16085526214482EB880DF182BD79924942C08F6D926E45F220ABB274D9D2BD2EC19596D407883F8C945412B7C046E9B6B47778E30E71FF5E6173739C256D48153A109D3E5C7D3631C8F012A18123CC481AA633324D2227EFB778D2EFECDABCD12EC9B7322202C301603FB34379FA8B9CF1E86F85C41194F82EFDC5405A9317625B863706886038CB03190915ABBBDE7113BFB0B99A24C4E24AAB108099F756A3DCE480FC1765F69DA50257E93E4486C8E78728387840BBE29C49D6BCDE59136A64B191CC9FDA31F181D8BB0F0D2CD3B7F08118B3387333E2AF9D819AA18DE8E65448BDB38BB0DBDC41EEA9E6D1650B50094DC08C9269E47A5BC7C3617359C66F0A6455BBB0240095E98649D2CB0C9C3CF5684750B4B079FBE20CF5CC52D254D05FE9929B42D8288F85AAE417480387A639035AA01EB50A0A4B943BCB813BFF3E4F4FDFCD6AB17AC39144D71F59ED93CCBC4637B5272BAF943EC17B83F6AC87F8DAF35E5116086B069BC04862FE4EB40EDBF54992BF6C939B69A5CF973DC43734B232E8A20ADD3A9FFF1DB7584C074AE1B40B3445DA3E59C1F7F97C646E8FE14E6DB8E3772F1720CB70DA70FB2CB9804CAE074AA5BFBF961353D0002A12A914651BD898792DB0C6ED46B8588336A8E10EF3F6EF5F86D5199B3C56F008A0E43113153223B91B4F8B6959543A0CC7C05E1AD5F3D0152D2D0A501F0B03B1A6B9C5F3A0C6BCE3BA85E6C50E48E30B696A05220737507B20BE661F9344D09825825450C36C5F1749D26CE5BD10CCBB54331702A672CB8F63D6DF055309A4A0281D73814A1F51BD9750891111AF978CDDFD833E8DFECEC4399E6E294821D1B85B6B15BDC7B091982F2FE8CA4B114237BE2EFA9AEB73C8088386FF3D98A1661CB33525BF0E7F53FFCD3B8602E8007C4CFA4E90F2710522DD992A40A0ACD8ED2262E1E15946AD0A56754830E6B8942A6A4BB8477AEF8F5A8AF6D600B12BE6712D4779FD0708B7C8D79709E389D4105B287A25C3810F46F39954F8B083B7A68818D026109C23F36B81DAE736652BA79578706530CD8584F097E6089CFE7395DEB512F7A28FFD66E6A1566022EE78027D240FBA0F3B9F865CBCE59B6A01F0770D254539EF17FAFDAC3AB745AA2D98969162D0237CAEDACB58F855F2A00587DC2980DB9F66C7AE798A13D38D850F240D714A13856B3DE70844DB8609581166454929CBDCC340CE6232BB2BCE6619DF7FC2C4890D40DA6D0143241D347DA4004371FDD0EA10AE3B2C206F3DCD1DFEABDD1EE56BCF52731A6E7AB1A2FEEACC60B158D3AAD4E7A0F6C5DCB781CC7669C7210E2BCABBDC0F66068DC2827632075C82966CD2E25B13E7C09CEB2754FF07D08D9A7728936AC78AD9F578FEE0B42E84E16E4DCF665F5465866BEF924505E2771F15C3E81E2FADA947BCC16B1F7C200DC8AF4B8993618F8303B301F300706052B0E03021A0414DB599DB4438665874FBC41EE53030366B425ACB004143FD475649B18567E78A1A7BA58F85C71FEE8B683020207D0", "hex");
            var stream = new trusted.Stream(pfx);
            var asn = new trusted.ASN(stream);
            console.log("ASN:", asn);
            var pkcs12 = asn.toObject("PFX");
            console.log(pkcs12);
            
            //console.log((trusted.isObject("asa"))?"Да":"Нет");

            trusted.schemas.Test = {
                type: "SEQUENCE",
                value: {
                    v1: {type: "INTEGER", context: 0, optional: true, default: 33, explicit: true},
                    v2: {type: "INTEGER", context: 1},
                    v3: {type: "GN", context: 2},
                    v4: {
                        type: "SEQUENCE",
                        maxOccurs: 10,
                        value: {
                            v: {type: "INTEGER"}
                        }
                    },
                    v5: {type: "ANY", optional: true}
                }
            };

            trusted.schemas.GN = {
                type: "CHOICE",
                value: {
                    ch1: {type: "INTEGER", context: 0},
                    ch3: {type: "N", context: 3}
                }
            };

            trusted.schemas.N = {
                type: "CHOICE",
                value: {
                    num: {type: "INTEGER"},
                    bool: {type: "BOOLEAN"}
                }
            };

            var o = {
                v1: 1,
                v2: 3,
                v3: {
                    ch3: {
                        bool: true
                    }
                },
                v4: [1, 2, 3, 4, 5, 6, 7, 8, 9],
                v5: new trusted.Buffer("010101","hex")
            };

            //console.log(new Schema("Test").value);
            var asn = trusted.ASN.fromObject(o, "Test");
            console.log(new trusted.Buffer(asn.stream.print(),"binary").toString("hex"));
            //a = Hex.toDer(a); // hex to der
            var a = new trusted.ASN(asn.stream.print()); // a to asn
            console.log("ASN(Test):%o", a.toObject("Test"));


        </script>
    </body>
</html>
