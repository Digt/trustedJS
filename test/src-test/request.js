RequestTest = TestCase("Request");

RequestTest.prototype.setUp = function() {
};

{
    {
        RequestTest.prototype.test_Request_new1 = function() {
            assertException(function() {
                new trusted.PKI.Request();
            });
        };
        RequestTest.prototype.test_Request_new2 = function() {
            var der = Hex.toDer("308202BD308201A50201003078310B30090603550406130252553110300E060355040813074D61726920456C311430120603550407130B596F73686B61722D4F6C61311F301D060355040B1316496E666F726D6174696F6E20546563686E6F6C6F6779310D300B060355040A1304446967743111300F06035504031308526571756573743130820122300D06092A864886F70D01010105000382010F003082010A0282010100AE66BF5CD10452B35841ABF7065D034D16F53B0C24A0DD6D64AF59DF9925410EA0CADD1803D2D840116DA712F0479CA00A8935521A6F54097DD4AA7313E4914318FDCB44F360642EE9FD9437CA788E6191A44FA55B54493167BBD9CCB26AC2DCD3D7EBE1DDAE9A6F11CA0DFA74868BE089BED976E8A237F43FE625FFB8B1CA1AE36311F705522C3A44BAE8709A355DF0EA913FC48CF9B8CAD1483C24994C524D3322DAADE1988DFF351FC985D67807BE0E39478C04B96537AD6693322548DDDB356F51ABE87830669C7AE61CBD479CE7F610EF1745C994A27801C59725D7174BD62A1E22B309F14274CDDCE4EACBE76F4A43C3F6D87A083CCFF13C93BBBC43A50203010001A000300D06092A864886F70D0101050500038201010044264F8870D81C46DCBE0C4D12309B92268B9A3AC4BAED28D907BDB78EEFB2957DEFA8FCF9F9A710AFC6B9217C912620C8D07EA4168F57C7405A1AC62AB890FBE26CCC1C9F8AE6D81E5D1F7D7A1BF078B48112F9C930016386AE9341D5F9038C8F628528D3175B9366CCB2277837AE97A3FE8512CA35721BAD44EEE7D447D0E91E22A9CB45098545C2A7FF360B3E5DD5AFF3736B5390DA365C2F3E6EE236E45A320BDE1B33F0C27CD92FDE8282C6903983DD955624D5D2E5E330A09123950A9839C3100FFE7A0DC55256ED108281B06204969BD71EDCB321C47AABB53EA485027452759B66EF5ECA1380EDA5D9575AF4F0FC55B8DA12E313EECF59628F4815B4");
            var req = new trusted.PKI.Request(der);
            var tbs = "308201A50201003078310B30090603550406130252553110300E060355040813074D61726920456C311430120603550407130B596F73686B61722D4F6C61311F301D060355040B1316496E666F726D6174696F6E20546563686E6F6C6F6779310D300B060355040A1304446967743111300F06035504031308526571756573743130820122300D06092A864886F70D01010105000382010F003082010A0282010100AE66BF5CD10452B35841ABF7065D034D16F53B0C24A0DD6D64AF59DF9925410EA0CADD1803D2D840116DA712F0479CA00A8935521A6F54097DD4AA7313E4914318FDCB44F360642EE9FD9437CA788E6191A44FA55B54493167BBD9CCB26AC2DCD3D7EBE1DDAE9A6F11CA0DFA74868BE089BED976E8A237F43FE625FFB8B1CA1AE36311F705522C3A44BAE8709A355DF0EA913FC48CF9B8CAD1483C24994C524D3322DAADE1988DFF351FC985D67807BE0E39478C04B96537AD6693322548DDDB356F51ABE87830669C7AE61CBD479CE7F610EF1745C994A27801C59725D7174BD62A1E22B309F14274CDDCE4EACBE76F4A43C3F6D87A083CCFF13C93BBBC43A50203010001A000";
            assertEquals(0, req.version);
            assertEquals(tbs, Der.toHex(req.TBSRequest));
            assertEquals("countryName=RU;stateOrProvinceName=Mari El;localityName=Yoshkar-Ola;organizationalUnitName=Information Technology;organizationName=Digt;commonName=Request1", req.subjectName.toString());
            assertEquals(6, req.subjectName.RDNs.length);

        };
        RequestTest.prototype.test_Request_toFromObject = function() {
            var der = Hex.toDer("308202BD308201A50201003078310B30090603550406130252553110300E060355040813074D61726920456C311430120603550407130B596F73686B61722D4F6C61311F301D060355040B1316496E666F726D6174696F6E20546563686E6F6C6F6779310D300B060355040A1304446967743111300F06035504031308526571756573743130820122300D06092A864886F70D01010105000382010F003082010A0282010100AE66BF5CD10452B35841ABF7065D034D16F53B0C24A0DD6D64AF59DF9925410EA0CADD1803D2D840116DA712F0479CA00A8935521A6F54097DD4AA7313E4914318FDCB44F360642EE9FD9437CA788E6191A44FA55B54493167BBD9CCB26AC2DCD3D7EBE1DDAE9A6F11CA0DFA74868BE089BED976E8A237F43FE625FFB8B1CA1AE36311F705522C3A44BAE8709A355DF0EA913FC48CF9B8CAD1483C24994C524D3322DAADE1988DFF351FC985D67807BE0E39478C04B96537AD6693322548DDDB356F51ABE87830669C7AE61CBD479CE7F610EF1745C994A27801C59725D7174BD62A1E22B309F14274CDDCE4EACBE76F4A43C3F6D87A083CCFF13C93BBBC43A50203010001A000300D06092A864886F70D0101050500038201010044264F8870D81C46DCBE0C4D12309B92268B9A3AC4BAED28D907BDB78EEFB2957DEFA8FCF9F9A710AFC6B9217C912620C8D07EA4168F57C7405A1AC62AB890FBE26CCC1C9F8AE6D81E5D1F7D7A1BF078B48112F9C930016386AE9341D5F9038C8F628528D3175B9366CCB2277837AE97A3FE8512CA35721BAD44EEE7D447D0E91E22A9CB45098545C2A7FF360B3E5DD5AFF3736B5390DA365C2F3E6EE236E45A320BDE1B33F0C27CD92FDE8282C6903983DD955624D5D2E5E330A09123950A9839C3100FFE7A0DC55256ED108281B06204969BD71EDCB321C47AABB53EA485027452759B66EF5ECA1380EDA5D9575AF4F0FC55B8DA12E313EECF59628F4815B4");
            var req = new trusted.PKI.Request(der);
            var obj = req.toObject();
            var req1 = new trusted.PKI.Request(obj);
            assertEquals("1.2.840.113549.1.1.5", req1.signatureAlgorithm.OID.value);
            assertEquals(6, req.subjectName.RDNs.length);
            assertEquals("\u0013\u0002RU", req.subjectName.RDNs[0].attributes[0].value);
            assertEquals("\u0013\u0007Mari El", req.subjectName.RDNs[1].attributes[0].value);
            assertEquals("\u0013\u000bYoshkar-Ola", req.subjectName.RDNs[2].attributes[0].value);
            assertEquals("\u0013\u0016Information Technology", req.subjectName.RDNs[3].attributes[0].value);
            assertEquals("\u0013\u0004Digt", req.subjectName.RDNs[4].attributes[0].value);
            assertEquals("\u0013\bRequest1", req.subjectName.RDNs[5].attributes[0].value);
        };
        RequestTest.prototype.test_Request_toString = function() {
            var der = Hex.toDer("308202BD308201A50201003078310B30090603550406130252553110300E060355040813074D61726920456C311430120603550407130B596F73686B61722D4F6C61311F301D060355040B1316496E666F726D6174696F6E20546563686E6F6C6F6779310D300B060355040A1304446967743111300F06035504031308526571756573743130820122300D06092A864886F70D01010105000382010F003082010A0282010100AE66BF5CD10452B35841ABF7065D034D16F53B0C24A0DD6D64AF59DF9925410EA0CADD1803D2D840116DA712F0479CA00A8935521A6F54097DD4AA7313E4914318FDCB44F360642EE9FD9437CA788E6191A44FA55B54493167BBD9CCB26AC2DCD3D7EBE1DDAE9A6F11CA0DFA74868BE089BED976E8A237F43FE625FFB8B1CA1AE36311F705522C3A44BAE8709A355DF0EA913FC48CF9B8CAD1483C24994C524D3322DAADE1988DFF351FC985D67807BE0E39478C04B96537AD6693322548DDDB356F51ABE87830669C7AE61CBD479CE7F610EF1745C994A27801C59725D7174BD62A1E22B309F14274CDDCE4EACBE76F4A43C3F6D87A083CCFF13C93BBBC43A50203010001A000300D06092A864886F70D0101050500038201010044264F8870D81C46DCBE0C4D12309B92268B9A3AC4BAED28D907BDB78EEFB2957DEFA8FCF9F9A710AFC6B9217C912620C8D07EA4168F57C7405A1AC62AB890FBE26CCC1C9F8AE6D81E5D1F7D7A1BF078B48112F9C930016386AE9341D5F9038C8F628528D3175B9366CCB2277837AE97A3FE8512CA35721BAD44EEE7D447D0E91E22A9CB45098545C2A7FF360B3E5DD5AFF3736B5390DA365C2F3E6EE236E45A320BDE1B33F0C27CD92FDE8282C6903983DD955624D5D2E5E330A09123950A9839C3100FFE7A0DC55256ED108281B06204969BD71EDCB321C47AABB53EA485027452759B66EF5ECA1380EDA5D9575AF4F0FC55B8DA12E313EECF59628F4815B4");
            var req = new trusted.PKI.Request(der);
            var str = req.toString(req);
            fail("it's doesn't work"); 
        };
        RequestTest.prototype.test_Request_getExtension = function() {
            var der = Hex.toDer("3082011B3081CB020100301E310B3009060355040613025255310F300D060355040313067465737430323063301C06062A8503020213301206072A85030202240006072A850302021E01034300044040D4454315A819E59C82D9FCECCDA54B872548494BE24BC1F322B6D4792DB50F4127D9AA0EED96B22E9C1154845BF9A096A7FEDDA53CEE1B131B787CCDFA6790A041303F060A2B06010401823702010E3131302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304300806062A85030202030341006AA430475FAF8303139E120C281B772F0C49A0D5BF8C722EECB474B7250F187EBB506B40113FCA8DC4CD8684CBC3D8BF469DC5454E1231D21FAAED1A06CBC155");
            var req = new trusted.PKI.Request(der);
            var ext = req.getExtension("2.5.29.15");
            assertEquals("keyUsage", ext.OID.name);
            assertEquals("2.5.29.15", ext.OID.value);
            assertEquals("\u0003\u0002\u0003Ø", ext.value);
            var ext2 = req.getExtension("2.5.29.37");
            assertEquals("extKeyUsage", ext2.OID.name);
            assertEquals("2.5.29.37", ext2.OID.value);
            assertEquals("0\u0014\u0006\b+\u0006\u0001\u0005\u0005\u0007\u0003\u0002\u0006\b+\u0006\u0001\u0005\u0005\u0007\u0003\u0004", ext2.value);
        };

        RequestTest.prototype.test_Request_getAttribute = function() {
            var der = Hex.toDer("308202E2308201CA020100306C310B3009060355040613025255310D300B06035504080C044D617269310D300B06035504070C04596F6C61310C300A060355040A0C034F72673113301106035504030C0A4D792072657175657374311C301A06092A864886F70D010901160D6D61696C40656D61696C2E727530820122300D06092A864886F70D01010105000382010F003082010A0282010100D290746BA53699B4F147CC2A9B60C40DB20242FDCF9C56D8E18E9CF97982CE6FF8B76CB1CD5CE7080CB5BAD294DAEC055022F54907EC3F84567A1D4EB5A21592421115271F7371C9F88E6D0F1EB1844092681D807CB3F8406C50157C803A2CBDAE8A5B9974BAFCA8EDB560115ADA5B57A41FCE7F0CD123EB3CC5CA5C2E6C7E91A7A73B656FC7DFF2E0DA7B8F06735914B6EDD2C8CCC2A90D353947578B9AA4E9AC8DA2F7F612506E1C8F81EB8EC4CA3E7DE687DEB633A757B6EA9DF8F983FEF9953EE21D49F26FEEB3A079FC2E135B3888604C3C0139B047FBAC18EE34B0842ABBF47EEB7029BCDD33C088822FBC2C0463BD784E43FF6F39FF47E2519CE855D50203010001A031301406092A864886F70D01090731070C053132333435301906092A864886F70D010902310C0C0A4F74686572206E616D65300D06092A864886F70D010105050003820101001558004CC249AF8CF56EF496B1C088113FB7788BF1196F36865A89ECA3C1E600F4FF7512ECE17F5EBB75B832B820C5FD0A9561987C89B20C5090FCA8E6F7BE4D508A71473ED5C1F65A3561E2850EEB89CE4832FDAF46DFE1D19D11BABF62F17915276D748D1C640A49287A93E1124C32F77A35FBECB643B86F2F8AF752553C547476B879EC21A96AE18D981C90C6FDB0AEFA9353D59F006745F4983FD3F0A29E6861C74BEE2E60D55B657285542AEEE45472A65DD110CE9C41DA5FD4B135C173123AD6CC2A20B2D696EFE995F4BD03574D81A4F0FAB5E23DCD9F22955984079CF42490B83B331A2AA275E7582364046A6755E49EBCE6E44B186D3F6B717B6836");
            var req = new trusted.PKI.Request(der);
            var attr = req.getAttribute("1.2.840.113549.1.9.7");
            var attr2 = req.getAttribute("1.2.840.113549.1.9.2");
            assertEquals("1.2.840.113549.1.9.7", attr.OID.value);
            assertEquals("PKCS #9", attr.OID.comment);
            assertEquals("1.2.840.113549.1.9.2", attr2.OID.value);
            assertEquals("PKCS #9", attr2.OID.comment);
        };
        RequestTest.prototype.test_Request_publicKey_fromDer = function() {
            var der = Hex.toDer("308202E2308201CA020100306C310B3009060355040613025255310D300B06035504080C044D617269310D300B06035504070C04596F6C61310C300A060355040A0C034F72673113301106035504030C0A4D792072657175657374311C301A06092A864886F70D010901160D6D61696C40656D61696C2E727530820122300D06092A864886F70D01010105000382010F003082010A0282010100D290746BA53699B4F147CC2A9B60C40DB20242FDCF9C56D8E18E9CF97982CE6FF8B76CB1CD5CE7080CB5BAD294DAEC055022F54907EC3F84567A1D4EB5A21592421115271F7371C9F88E6D0F1EB1844092681D807CB3F8406C50157C803A2CBDAE8A5B9974BAFCA8EDB560115ADA5B57A41FCE7F0CD123EB3CC5CA5C2E6C7E91A7A73B656FC7DFF2E0DA7B8F06735914B6EDD2C8CCC2A90D353947578B9AA4E9AC8DA2F7F612506E1C8F81EB8EC4CA3E7DE687DEB633A757B6EA9DF8F983FEF9953EE21D49F26FEEB3A079FC2E135B3888604C3C0139B047FBAC18EE34B0842ABBF47EEB7029BCDD33C088822FBC2C0463BD784E43FF6F39FF47E2519CE855D50203010001A031301406092A864886F70D01090731070C053132333435301906092A864886F70D010902310C0C0A4F74686572206E616D65300D06092A864886F70D010105050003820101001558004CC249AF8CF56EF496B1C088113FB7788BF1196F36865A89ECA3C1E600F4FF7512ECE17F5EBB75B832B820C5FD0A9561987C89B20C5090FCA8E6F7BE4D508A71473ED5C1F65A3561E2850EEB89CE4832FDAF46DFE1D19D11BABF62F17915276D748D1C640A49287A93E1124C32F77A35FBECB643B86F2F8AF752553C547476B879EC21A96AE18D981C90C6FDB0AEFA9353D59F006745F4983FD3F0A29E6861C74BEE2E60D55B657285542AEEE45472A65DD110CE9C41DA5FD4B135C173123AD6CC2A20B2D696EFE995F4BD03574D81A4F0FAB5E23DCD9F22955984079CF42490B83B331A2AA275E7582364046A6755E49EBCE6E44B186D3F6B717B6836");
            var req = new trusted.PKI.Request(der);
            var pbk = req.publicKey;
            assertEquals("rsaEncryption", pbk.algorithm.OID.name);
            assertEquals("1.2.840.113549.1.1.1", pbk.algorithm.OID.value);
        };
        RequestTest.prototype.test_Request_publicKey_fromObject = function() {
            var obj = {
                "certificationRequestInfo":
                        {
                            "version": 0,
                            "subject":
                                    {
                                        "rdnSequence":
                                                [
                                                    [
                                                        {
                                                            "type": "2.5.4.6",
                                                            "value": "\u0013\u0002RU"
                                                        }
                                                    ],
                                                    [
                                                        {
                                                            "type": "2.5.4.8",
                                                            "value": "\f\u0004Mari"
                                                        }
                                                    ],
                                                    [
                                                        {
                                                            "type": "2.5.4.7",
                                                            "value": "\f\u0004Yola"
                                                        }
                                                    ],
                                                    [
                                                        {
                                                            "type": "2.5.4.10",
                                                            "value": "\f\u0003Org"
                                                        }
                                                    ],
                                                    [
                                                        {
                                                            "type": "2.5.4.3",
                                                            "value": "\f\nMy request"
                                                        }
                                                    ],
                                                    [
                                                        {
                                                            "type": "1.2.840.113549.1.9.1",
                                                            "value": "\u0016\rmail@email.ru"
                                                        }
                                                    ]
                                                ]
                                    },
                            "subjectPKInfo":
                                    {
                                        "algorithm":
                                                {
                                                    "algorithm": "1.2.840.113549.1.1.1",
                                                    "parameters": null
                                                },
                                        "subjectPublicKey":
                                                {
                                                    "unusedBit": 0,
                                                    "encoded": "0\u0001\n\u0002\u0001\u0001\u0000Òtk¥6´ñGÌ*`Ä\r²\u0002BýÏVØáùyÎoø·l±Í\\ç\b\fµºÒÚì\u0005P\"õI\u0007ì?Vz\u001dNµ¢\u0015B\u0011\u0015'\u001fsqÉøm\u000f\u001e±@h\u001d|³ø@lP\u0015|:,½®[tºü¨íµ`\u0011ZÚ[W¤\u001fÎ\fÑ#ë<ÅÊ\\.l~§§;eoÇßòàÚ{\u0006sY\u0014¶íÒÈÌÂ©\r59GW¤é¬¢÷ö\u0012Pn\u001cëÄÊ>}æÞ¶3§W¶êøùþù>â\u001dIòoî³ yü.\u0013[8`L<\u00019°Gû¬\u0018î4°*»ô~ëp)¼Ý3À/¼,\u0004c½xNCÿo9ÿGâQèUÕ\u0002\u0003\u0001\u0000\u0001"
                                                }
                                    },
                            "attributes":
                                    [
                                        {
                                            "type": "1.2.840.113549.1.9.7",
                                            "values":
                                                    [
                                                        "\f\u000512345"
                                                    ]
                                        },
                                        {
                                            "type": "1.2.840.113549.1.9.2",
                                            "values":
                                                    [
                                                        "\f\nOther name"
                                                    ]
                                        }
                                    ]
                        },
                "signatureAlgorithm":
                        {
                            "algorithm": "1.2.840.113549.1.1.5",
                            "parameters": null
                        },
                "signature":
                        {
                            "unusedBit": 0,
                            "encoded": "\u0015X\u0000LÂI¯õnô±À\u0011?·xñ\u0019o6Zì£Áæ\u0000ôÿu\u0012ìá^»u¸2¸ Åý\na|²\fPü¨æ÷¾MPqG>ÕÁöZ5aâ\u000eëÎH2ý¯FßáÑ\u0011º¿bñy\u0015'mt\u001cd\nI(zá\u0012L2÷z5ûì¶C¸o/÷RU<Ttv¸yì!©já\u001cÆý°®úSÕ\u0000gEô?Óð¢haÇKî.`Õ[erT*îäTr¦]Ñ\u0010ÎAÚ_Ô±5Ás\u0012:ÖÌ* ²Öïéô½\u0003WM¤ðúµâ=Í\"Y\u0007ô$¸;3\u001a*¢uçX#d\u0004jgUä¼æäK\u0018m?kq{h6"
                        }
            };
            var req = new trusted.PKI.Request(obj);
            var pbk = req.publicKey;
            assertEquals("rsaEncryption", pbk.algorithm.OID.name);
            assertEquals("1.2.840.113549.1.1.1", pbk.algorithm.OID.value);
        };
        RequestTest.prototype.test_Request_publicKey_toObject = function() {
            var der = Hex.toDer("308202E2308201CA020100306C310B3009060355040613025255310D300B06035504080C044D617269310D300B06035504070C04596F6C61310C300A060355040A0C034F72673113301106035504030C0A4D792072657175657374311C301A06092A864886F70D010901160D6D61696C40656D61696C2E727530820122300D06092A864886F70D01010105000382010F003082010A0282010100D290746BA53699B4F147CC2A9B60C40DB20242FDCF9C56D8E18E9CF97982CE6FF8B76CB1CD5CE7080CB5BAD294DAEC055022F54907EC3F84567A1D4EB5A21592421115271F7371C9F88E6D0F1EB1844092681D807CB3F8406C50157C803A2CBDAE8A5B9974BAFCA8EDB560115ADA5B57A41FCE7F0CD123EB3CC5CA5C2E6C7E91A7A73B656FC7DFF2E0DA7B8F06735914B6EDD2C8CCC2A90D353947578B9AA4E9AC8DA2F7F612506E1C8F81EB8EC4CA3E7DE687DEB633A757B6EA9DF8F983FEF9953EE21D49F26FEEB3A079FC2E135B3888604C3C0139B047FBAC18EE34B0842ABBF47EEB7029BCDD33C088822FBC2C0463BD784E43FF6F39FF47E2519CE855D50203010001A031301406092A864886F70D01090731070C053132333435301906092A864886F70D010902310C0C0A4F74686572206E616D65300D06092A864886F70D010105050003820101001558004CC249AF8CF56EF496B1C088113FB7788BF1196F36865A89ECA3C1E600F4FF7512ECE17F5EBB75B832B820C5FD0A9561987C89B20C5090FCA8E6F7BE4D508A71473ED5C1F65A3561E2850EEB89CE4832FDAF46DFE1D19D11BABF62F17915276D748D1C640A49287A93E1124C32F77A35FBECB643B86F2F8AF752553C547476B879EC21A96AE18D981C90C6FDB0AEFA9353D59F006745F4983FD3F0A29E6861C74BEE2E60D55B657285542AEEE45472A65DD110CE9C41DA5FD4B135C173123AD6CC2A20B2D696EFE995F4BD03574D81A4F0FAB5E23DCD9F22955984079CF42490B83B331A2AA275E7582364046A6755E49EBCE6E44B186D3F6B717B6836");
            var req = new trusted.PKI.Request(der);
            var pbk = req.publicKey.toObject();
            assertEquals("1.2.840.113549.1.1.1", pbk.algorithm.algorithm);
        };
        RequestTest.prototype.test_Request_publicKey_toString = function() {
            var der = Hex.toDer("308202E2308201CA020100306C310B3009060355040613025255310D300B06035504080C044D617269310D300B06035504070C04596F6C61310C300A060355040A0C034F72673113301106035504030C0A4D792072657175657374311C301A06092A864886F70D010901160D6D61696C40656D61696C2E727530820122300D06092A864886F70D01010105000382010F003082010A0282010100D290746BA53699B4F147CC2A9B60C40DB20242FDCF9C56D8E18E9CF97982CE6FF8B76CB1CD5CE7080CB5BAD294DAEC055022F54907EC3F84567A1D4EB5A21592421115271F7371C9F88E6D0F1EB1844092681D807CB3F8406C50157C803A2CBDAE8A5B9974BAFCA8EDB560115ADA5B57A41FCE7F0CD123EB3CC5CA5C2E6C7E91A7A73B656FC7DFF2E0DA7B8F06735914B6EDD2C8CCC2A90D353947578B9AA4E9AC8DA2F7F612506E1C8F81EB8EC4CA3E7DE687DEB633A757B6EA9DF8F983FEF9953EE21D49F26FEEB3A079FC2E135B3888604C3C0139B047FBAC18EE34B0842ABBF47EEB7029BCDD33C088822FBC2C0463BD784E43FF6F39FF47E2519CE855D50203010001A031301406092A864886F70D01090731070C053132333435301906092A864886F70D010902310C0C0A4F74686572206E616D65300D06092A864886F70D010105050003820101001558004CC249AF8CF56EF496B1C088113FB7788BF1196F36865A89ECA3C1E600F4FF7512ECE17F5EBB75B832B820C5FD0A9561987C89B20C5090FCA8E6F7BE4D508A71473ED5C1F65A3561E2850EEB89CE4832FDAF46DFE1D19D11BABF62F17915276D748D1C640A49287A93E1124C32F77A35FBECB643B86F2F8AF752553C547476B879EC21A96AE18D981C90C6FDB0AEFA9353D59F006745F4983FD3F0A29E6861C74BEE2E60D55B657285542AEEE45472A65DD110CE9C41DA5FD4B135C173123AD6CC2A20B2D696EFE995F4BD03574D81A4F0FAB5E23DCD9F22955984079CF42490B83B331A2AA275E7582364046A6755E49EBCE6E44B186D3F6B717B6836");
            var req = new trusted.PKI.Request(der);
            var pbk = req.publicKey.toString();
            assertEquals("rsaEncryption (1.2.840.113549.1.1.1) (2048 Bits)", pbk);
        };
        RequestTest.prototype.test_RequestAttribute = function() {
            var der = Hex.toDer("303F060A2B06010401823702010E3131302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304");
            var req = new trusted.PKI.RequestAttribute(der);
            assertEquals("certReqExtensions",req.OID.name);
            assertEquals("1.3.6.1.4.1.311.2.1.14",req.OID.value);
        };
        RequestTest.prototype.test_RequestAttribute_fromObject = function() {
            var obj =
                    {
                                        "type": "1.3.6.1.4.1.311.2.1.14",
                                        "values":
                                                [
                                                    "0/0\u000e\u0006\u0003U\u001d\u000f\u0001\u0001ÿ\u0004\u0004\u0003\u0002\u0003Ø0\u001d\u0006\u0003U\u001d%\u0004\u00160\u0014\u0006\b+\u0006\u0001\u0005\u0005\u0007\u0003\u0002\u0006\b+\u0006\u0001\u0005\u0005\u0007\u0003\u0004"
                                                ]
                    };
            var req = new trusted.PKI.RequestAttribute(obj);
            assertEquals("certReqExtensions",req.OID.name);
            assertEquals("1.3.6.1.4.1.311.2.1.14",req.OID.value);
        };
        RequestTest.prototype.test_RequestAttribute_toObject = function() {
            var der = Hex.toDer("303F060A2B06010401823702010E3131302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304");
            var req1 = new trusted.PKI.RequestAttribute(der);
            var req = req1.toObject();
            assertEquals("1.3.6.1.4.1.311.2.1.14",req.type);
            assertEquals("302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304",Der.toHex(req.values[0]));
        };
        RequestTest.prototype.test_RequestAttribute_toString = function() {
            var der = Hex.toDer("303F060A2B06010401823702010E3131302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304");
            var req1 = new trusted.PKI.RequestAttribute(der);
            var req = req1.toString();
            assertEquals("Attribute (certReqExtensions (1.3.6.1.4.1.311.2.1.14)): 302F300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304",req);
        };
    }
}