CertificateTest = TestCase("Certificate");
CertificateTest.prototype.setUp = function () {

};

{
    {
        CertificateTest.prototype.test_new_1 = function () {
            var der = Hex.toDer("3082031730820280A003020102020436E7AD9C300D06092A864886F70D01010505003040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031301E170D3939303331313131313834385A170D3139303331313131343834385A3040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B13044341203130819D300D06092A864886F70D010101050003818B0030818702818100B0B367A796B57683E91603D91AA076D574E79C05D2513FDB4F19A1A8394ECB247D61C41E6A20AE0F81DEEAB839FD1B1F6B3640ED4D2125F2A3D9A151D86CC01B96F8D44294D4A7CE1B8FD35426A284EF3285AF4A3FF13236AF3DE63A27EB03C2257EF4612BAD8A1A4BE69B3668D42FE5D28894DC16AADAC2154C6CC3E11991C9020103A382011E3082011A301106096086480186F842010104040302000730620603551D1F045B30593057A055A053A451304F310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031310D300B0603550403130443524C31302B0603551D1004243022800F31393939303331313131313834385A810F32303139303331313131313834385A300B0603551D0F040403020106301F0603551D230418301680142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC301D0603551D0E041604142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC300C0603551D13040530030101FF301906092A864886F67D074100040C300A1B0456342E3003020490300D06092A864886F70D01010505000381810053DFD2E9F0EEE3DA00678FEA1547761FE0B5A4A04702C2B3D8B44AD4FBAC1C81B923206362D8546F0975D63AE630ABB173BC14A4FE442F5264D016632D39B6E938EE653390D18118800567236F3C1D427CD1F1F386A0FACB566CBE1BF5329C6193BBDFEDC04FC1D1E545CEE3441588D7CCC3FCAB189651F4E0A87CC1CB98BCC1");
            var dps = new trusted.PKI.Certificate(der);
            assertEquals("2", dps.version);
            assertEquals("921152924", dps.serialNumber);
            assertEquals("8", dps.extensions.length);
            assertEquals("1999", dps.notBefore.getFullYear());
            assertEquals("2019", dps.notAfter.getFullYear());
            assertEquals("2", dps.notBefore.getMonth(), dps.notAfter.getMonth());
            assertEquals("11", dps.notAfter.getDate(), dps.notBefore.getDate());
            assertEquals("4", dps.issuerName.RDNs.length, dps.subjectName.RDNs.length);

        };

        CertificateTest.prototype.test_fromObject = function () {
            var obj = {
                tbsCertificate: {
                    version: 2,
                    serialNumber: 1,
                    signature: {
                        algorithm: "1.2.840.113549.1.1.4",
                        parameters: Hex.toDer("0500")
                    },
                    issuer: {
                        rdnSequence: [
                            [{type: "2.5.4.6", value: trusted.ASN.fromObject("US", "UTF8_STRING").encode()}],
                            [{type: "2.5.4.10", value: trusted.ASN.fromObject("MSFT", "UTF8_STRING").encode()}],
                            [{type: "2.5.4.3", value: trusted.ASN.fromObject("Microsoft Authenticode(tm) Root Authority", "UTF8_STRING").encode()}]
                        ]
                    },
                    validity: {
                        notBefore: {
                            utcTime: new Date()},
                        notAfter: {
                            utcTime: new Date()}
                    },
                    subject: {
                        rdnSequence: [
                            [{type: "2.5.4.6", value: trusted.ASN.fromObject("US", "UTF8_STRING").encode()}],
                            [{type: "2.5.4.10", value: trusted.ASN.fromObject("MSFT", "UTF8_STRING").encode()}],
                            [{type: "2.5.4.3", value: trusted.ASN.fromObject("Microsoft Authenticode(tm) Root Authority", "UTF8_STRING").encode()}]
                        ]
                    },
                    subjectPublicKeyInfo: {
                        algorithm: {
                            algorithm: "1.2.840.113549.1.1.1",
                            parameters: Hex.toDer("0500")
                        },
                        subjectPublicKey: new BitString(Hex.toDer("003082010A0282010100DF08BAE33F6E649BF589AF28964A078F1B2E8B3E1DFCB88069A3A1CEDBDFB08E6C8976294FCA603539AD7232E00BAE293D4C16D94B3C9DDAC5D3D109C92C6FA6C2605345DD4BD155CD031CD2595624F3E578D807CCD8B31F903FC01A71501D2DA712086D7CB0866CC7BA853207E1616FAF03C56DE5D6A18F36F6C10BD13E69974872C97FA4C8C24A4C7EA1D194A6D7DCEB05462EB818B4571D8649DB694A2C21F55E0F542D5A43A97A7E6A8E504D2557A1BF1B1505437B2C058DBD3D038C93227D63EA0A5705060ADB6198652D4749A8E7E656755CB8640863A9304066B2F9B6E334E86730E1430B87FFC9BE72105E23F09BA74865BF09887BCD72BC2E799B7B0203010001"), 0)
                    }
                },
                signatureAlgorithm: {
                    "algorithm": "1.2.840.113549.1.1.4",
                    parameters: Hex.toDer("0500")},
                signature: new BitString(Hex.toDer("002DC9E2F6129E5D5667FAFA4B9A7EDC29565C80140228856E26F3CD58DA5080C5F819B3A67CE29D6B5F3B8F2274E61804FC4740D87A3F3066F012A4D1EB1DE7B6F498AB5322865158EE230976E41D455C4BFF4CE302500113CC41A45297D486D5C4FE8383657DEABEA2683BC1B12998BFA2A5FC9DD384EE701750F30BFA3CEFA9278B91B448C845A0E101424B4476041CC219A28E6B2098C4DD02ACB4D2A20E8D5DB9368E4A1B5D6C1AE2CB007F10F4B295EFE3E8FFA17358A9752CA2499585FECCDA448AC21244D244C8A5A21FA95A8E56C2C37BCF4260DC821FFBCE74067ED6F1AC196A4F745CC51566316CC16271910F595B7D2A821ADFB1B4D81D37DE0D0F"), 0)
            };

            var cert = new trusted.PKI.Certificate(obj);
            assertEquals(2, cert.version);
            assertEquals(1, cert.serialNumber);
        };
        CertificateTest.prototype.test_checkValidity = function () {
            var der = Hex.toDer("3082031730820280A003020102020436E7AD9C300D06092A864886F70D01010505003040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031301E170D3939303331313131313834385A170D3139303331313131343834385A3040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B13044341203130819D300D06092A864886F70D010101050003818B0030818702818100B0B367A796B57683E91603D91AA076D574E79C05D2513FDB4F19A1A8394ECB247D61C41E6A20AE0F81DEEAB839FD1B1F6B3640ED4D2125F2A3D9A151D86CC01B96F8D44294D4A7CE1B8FD35426A284EF3285AF4A3FF13236AF3DE63A27EB03C2257EF4612BAD8A1A4BE69B3668D42FE5D28894DC16AADAC2154C6CC3E11991C9020103A382011E3082011A301106096086480186F842010104040302000730620603551D1F045B30593057A055A053A451304F310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031310D300B0603550403130443524C31302B0603551D1004243022800F31393939303331313131313834385A810F32303139303331313131313834385A300B0603551D0F040403020106301F0603551D230418301680142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC301D0603551D0E041604142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC300C0603551D13040530030101FF301906092A864886F67D074100040C300A1B0456342E3003020490300D06092A864886F70D01010505000381810053DFD2E9F0EEE3DA00678FEA1547761FE0B5A4A04702C2B3D8B44AD4FBAC1C81B923206362D8546F0975D63AE630ABB173BC14A4FE442F5264D016632D39B6E938EE653390D18118800567236F3C1D427CD1F1F386A0FACB566CBE1BF5329C6193BBDFEDC04FC1D1E545CEE3441588D7CCC3FCAB189651F4E0A87CC1CB98BCC1");
            var dps = new trusted.PKI.Certificate(der);
            assertEquals(false, dps.checkValidity(new Date("1999-03-10 11:18:48 UTC"))); // раньше
            assertEquals(false, dps.checkValidity(new Date("1999-03-11 11:18:47 UTC"))); // раньше на 1 сек
            assertEquals(true, dps.checkValidity(new Date("1999-03-11 11:18:48 UTC")));  // равно началу
            assertEquals(true, dps.checkValidity(new Date("1999-03-12 11:18:48 UTC")));  // между
            assertEquals(true, dps.checkValidity(new Date("2019-03-11 11:48:47 UTC")));  // за 1 сек до конца
            assertEquals(true, dps.checkValidity(new Date("2019-03-11 11:48:48 UTC")));  // равно окончанию
            assertEquals(false, dps.checkValidity(new Date("2019-03-12 11:48:48 UTC"))); // позже
        };
        CertificateTest.prototype.test_getExtension_fromString = function () {
            var der = Hex.toDer("3082031730820280A003020102020436E7AD9C300D06092A864886F70D01010505003040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031301E170D3939303331313131313834385A170D3139303331313131343834385A3040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B13044341203130819D300D06092A864886F70D010101050003818B0030818702818100B0B367A796B57683E91603D91AA076D574E79C05D2513FDB4F19A1A8394ECB247D61C41E6A20AE0F81DEEAB839FD1B1F6B3640ED4D2125F2A3D9A151D86CC01B96F8D44294D4A7CE1B8FD35426A284EF3285AF4A3FF13236AF3DE63A27EB03C2257EF4612BAD8A1A4BE69B3668D42FE5D28894DC16AADAC2154C6CC3E11991C9020103A382011E3082011A301106096086480186F842010104040302000730620603551D1F045B30593057A055A053A451304F310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031310D300B0603550403130443524C31302B0603551D1004243022800F31393939303331313131313834385A810F32303139303331313131313834385A300B0603551D0F040403020106301F0603551D230418301680142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC301D0603551D0E041604142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC300C0603551D13040530030101FF301906092A864886F67D074100040C300A1B0456342E3003020490300D06092A864886F70D01010505000381810053DFD2E9F0EEE3DA00678FEA1547761FE0B5A4A04702C2B3D8B44AD4FBAC1C81B923206362D8546F0975D63AE630ABB173BC14A4FE442F5264D016632D39B6E938EE653390D18118800567236F3C1D427CD1F1F386A0FACB566CBE1BF5329C6193BBDFEDC04FC1D1E545CEE3441588D7CCC3FCAB189651F4E0A87CC1CB98BCC1");
            var dps = new trusted.PKI.Certificate(der);
            var str = "2.5.29.16";
            assertEquals("2.5.29.16", dps.getExtension(str).OID.value);
        };
        CertificateTest.prototype.test_getExtension_fromOID = function () {
            var der = Hex.toDer("3082031730820280A003020102020436E7AD9C300D06092A864886F70D01010505003040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031301E170D3939303331313131313834385A170D3139303331313131343834385A3040310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B13044341203130819D300D06092A864886F70D010101050003818B0030818702818100B0B367A796B57683E91603D91AA076D574E79C05D2513FDB4F19A1A8394ECB247D61C41E6A20AE0F81DEEAB839FD1B1F6B3640ED4D2125F2A3D9A151D86CC01B96F8D44294D4A7CE1B8FD35426A284EF3285AF4A3FF13236AF3DE63A27EB03C2257EF4612BAD8A1A4BE69B3668D42FE5D28894DC16AADAC2154C6CC3E11991C9020103A382011E3082011A301106096086480186F842010104040302000730620603551D1F045B30593057A055A053A451304F310B30090603550406130247423110300E060355040A1307566961436F64653110300E060355040B130743412044617461310D300B060355040B130443412031310D300B0603550403130443524C31302B0603551D1004243022800F31393939303331313131313834385A810F32303139303331313131313834385A300B0603551D0F040403020106301F0603551D230418301680142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC301D0603551D0E041604142887B1A7887FD6DDCB6FA11C0E5AD02E15319DCC300C0603551D13040530030101FF301906092A864886F67D074100040C300A1B0456342E3003020490300D06092A864886F70D01010505000381810053DFD2E9F0EEE3DA00678FEA1547761FE0B5A4A04702C2B3D8B44AD4FBAC1C81B923206362D8546F0975D63AE630ABB173BC14A4FE442F5264D016632D39B6E938EE653390D18118800567236F3C1D427CD1F1F386A0FACB566CBE1BF5329C6193BBDFEDC04FC1D1E545CEE3441588D7CCC3FCAB189651F4E0A87CC1CB98BCC1");
            var cert = new trusted.PKI.Certificate(der);
            var oid = new trusted.PKI.OID("2.5.29.16");
            assertEquals("2.5.29.16", cert.getExtension(oid).OID.value);
        };
        CertificateTest.prototype.test_checkExtension_fromOID_null = function () {
            var oid = new trusted.PKI.Certificate();
            oid.value = "";
            assertNull(oid.getExtension());
        };
        CertificateTest.prototype.test_checkExtension_fromOID_undefined = function () {
            var oid = new trusted.PKI.Certificate();
            assertNotUndefined(oid.getExtension());
        };
        CertificateTest.prototype.test_isSelfSigned = function () {
            var der = Hex.toDer("308207C9308205B1A003020102020101300D06092A864886F70D0101050500307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F72697479301E170D3036303931373139343633365A170D3336303931373139343633365A307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F7269747930820222300D06092A864886F70D01010105000382020F003082020A0282020100C188DB09BC6C467C789F957BB53390F27262D6C1362022245ECEE977F2430AA20664A4CC8E36F838E623F06E6DB13CDD72A3851CA1D33DB4332BD32FAFFEEAB0415967B6C4067D0A9E7485D6794C80377ADF39055259F7F41B4643A4D28585D2C371F3756234BA2C8A7F1E8FEEED34D011C796CD523DBA33D6DD4DDE0B3B4A4B9FC2262FFAB5161C723577CA3C5DE6CAE1268B1A36765C01DB741425FEEDB5A0880FDD78CA2D1F079730012D7279FA46D6132AA8B9A6AB83491DE5F2EFDDE4018E180A8F6353168562A90E193ACCB566A6C26B7407E42BE1763EB46DD8F644E173621F3BC4BEA05356256C5109F7AAABCABF76FD6D9BF39DDBBF3D66BC0C56AAAF9848953A4BDFA75850D93875A95BEA430C02FF99EBE86C4D705B29659CDDAA5DCCAF0131EC0CEBD28DE8EA9C7BE66EF727660C1A48D76E42E33FDE213E7BE10D70FB63AAA86C1A54B45C257AC9A2C98B16A6BB2C7E175E054D586E121D01EE12100DC6327F18FFFCF4FACD6E91E83649BE1A48698BC2964D1A12B26917C10A90D6FA792248BFBA7B69F870C7FA7A37D8D80DD2764F57FF90B7E391D2DDEFC260B7673ADDFEAA9CF0D48B7F7222CEC69F97B6F8AF8AA010A8D9FB18C6B6B55C523C89B6192A73010A0F03B31260F27A2F81DBA36EFF263097F58BDD8957B6AD3DB3AF2BC5B77602F0A5D62B9A86142A72F6E3338C5D094B13DFBB8C7413524B0203010001A38202523082024E300C0603551D13040530030101FF300B0603551D0F0404030201AE301D0603551D0E041604144E0BEF1AA4405BA517698730CA346843D041AEF230640603551D1F045D305B302CA02AA0288626687474703A2F2F636572742E7374617274636F6D2E6F72672F73667363612D63726C2E63726C302BA029A0278625687474703A2F2F63726C2E7374617274636F6D2E6F72672F73667363612D63726C2E63726C3082015D0603551D2004820154308201503082014C060B2B0601040181B5370101013082013B302F06082B060105050702011623687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466303506082B060105050702011629687474703A2F2F636572742E7374617274636F6D2E6F72672F696E7465726D6564696174652E7064663081D006082B060105050702023081C330271620537461727420436F6D6D65726369616C20285374617274436F6D29204C74642E30030201011A81974C696D69746564204C696162696C6974792C2072656164207468652073656374696F6E202A4C6567616C204C696D69746174696F6E732A206F6620746865205374617274436F6D2043657274696669636174696F6E20417574686F7269747920506F6C69637920617661696C61626C6520617420687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466301106096086480186F8420101040403020007303806096086480186F842010D042B16295374617274436F6D20467265652053534C2043657274696669636174696F6E20417574686F72697479300D06092A864886F70D01010505000382020100166C99F4660C34F5D0855E7D0AECDA104E381C5EDFA625054B9132C1E83BF13DDD44095B07498A29CB6602B7B19AF72598093C8E1BE1DD36872B4BBB68D339663DA026C7F239911D51AB827B7ED5CE5AE4E2035770699708F95E58A60ADF8C069A451616380A5E57F662C77A0205E6BC1EB5F29EF4A92983F8B214E36E288744C3901ADE38A93CAC434D6445CEDD28A95CF2737B04F817E8ABB1F32E5C646E73313A12B8BCB311E47D8F81519A3B8D89F44D93667B3C03EDD39A1D9AF36550F5A0D0759F2FAFF0EA824398F8699C8979C4438E4672E3643612AFF7251E388990777EC36B6AB9C3CB444BAC78908BE7C72C1E4B1144C8345227CD0A5D9F85C189D51A78F295105332DD80846675D9B56828FB612EBE84A838C0991286A51E6764AD062E2FA97085C7960F7C8965F58E43540EABDDA580399460C034C996702CA312F51F487BBD1C7E6BB79D90F4223BAEF8FC2ACAFA8252A0EFAF4B5593EBC1B5F0228BAC344E262204A1872C754AB7E57D13D7B80C64C036D2C92F86128C2309C11B823B7349A36A578794E5D678C5994363E34DE0772DE165997269041A4709E60F015624FB1FBF0E79A9582EB9C409017E95BA6D00063EB2EA4A1039D8D02BF5BFEC75BF9702C5091B08DC5537E281FB3784436220CAE7564B65EAFE6CC1249324A134EB05FF9A22AE9B7D3FF165510AA6306AB3F4881C800DFC728AE8835E");
            var cert = new trusted.PKI.Certificate(der);
            assertTrue(cert.isSelfSigned());
            var der1 = Hex.toDer("308207B130820760A003020102020A6B695070000000000022300806062A850302020330820121311A301806082A85030381030101120C3030373731303437343337353118301606052A85036401120D31303437373032303236373031311E301C06092A864886F70D010901160F646974406D696E737679617A2E7275313C303A06035504090C3331323533373520D0B32E20D09CD0BED181D0BAD0B2D0B020D183D0BB2E20D0A2D0B2D0B5D180D181D0BAD0B0D18F20D0B42E37312C302A060355040A0C23D09CD0B8D0BDD0BAD0BED0BCD181D0B2D18FD0B7D18C20D0A0D0BED181D181D0B8D0B83115301306035504070C0CD09CD0BED181D0BAD0B2D0B0311C301A06035504080C13373720D0B32E20D09CD0BED181D0BAD0B2D0B0310B3009060355040613025255311B301906035504030C12D0A3D0A6203120D098D0A120D093D0A3D0A6301E170D3132303830393131343330305A170D3133303830393131353230305A3082011F3118301606052A85036401120D31303337373030303835343434311A301806082A85030381030101120C3030373731373130373939313139303706035504090C30D183D0BB2E20D0A1D183D189D191D0B2D181D0BAD0B8D0B920D0B2D0B0D0BB2C20D0B42E31362C20D181D182D1802E35311F301D06092A864886F70D01090116107163614063727970746F70726F2E7275310B30090603550406130252553119301706035504080C10D0B32E20D09CD0BED181D0BAD0B2D0B03115301306035504070C0CD09CD0BED181D0BAD0B2D0B031253023060355040A0C1CD09ED09ED09E2022D09AD0A0D098D09FD0A2D09E2DD09FD0A0D09E223125302306035504030C1CD09ED09ED09E2022D09AD0A0D098D09FD0A2D09E2DD09FD0A0D09E223063301C06062A8503020213301206072A85030202230106072A850302021E010343000440668100EF041E01A44AB399AE7136DE9EFE4B687A95334392E6EF48A1543586F3C83D71E883DAB1C34226587F94D87F6E27343411BBAF9AF3D93EB59AFA8F3049A38204743082047030120603551D130101FF040830060101FF020100301D0603551D0E041604145B1E9160969F9AED57B5AAA763F12D4770D85C18300B0603551D0F040403020186301006092B0601040182371501040302010030250603551D20041E301C300806062A8503647101300806062A850364710230060604551D2000303606052A8503646F042D0C2B22D09AD180D0B8D0BFD182D0BED09FD180D0BE20435350222028D0B2D0B5D180D181D0B8D18F20332E3629308201860603551D230482017D308201798014F4662F3C5DD85C645D2B2DDEA31E91FD8818FE3AA1820152A482014E3082014A311E301C06092A864886F70D010901160F646974406D696E737679617A2E7275310B3009060355040613025255311C301A06035504080C13373720D0B32E20D09CD0BED181D0BAD0B2D0B03115301306035504070C0CD09CD0BED181D0BAD0B2D0B0313F303D06035504090C3631323533373520D0B32E20D09CD0BED181D0BAD0B2D0B02C20D183D0BB2E20D0A2D0B2D0B5D180D181D0BAD0B0D18F2C20D0B42E2037312C302A060355040A0C23D09CD0B8D0BDD0BAD0BED0BCD181D0B2D18FD0B7D18C20D0A0D0BED181D181D0B8D0B83118301606052A85036401120D31303437373032303236373031311A301806082A85030381030101120C3030373731303437343337353141303F06035504030C38D093D0BED0BBD0BED0B2D0BDD0BED0B920D183D0B4D0BED181D182D0BED0B2D0B5D180D18FD18ED189D0B8D0B920D186D0B5D0BDD182D180820B00D5C9E8E300000000000C305D0603551D1F045630543028A026A0248622687474703A2F2F726F7374656C65636F6D2E72752F6364702F76677563312E63726C3028A026A0248622687474703A2F2F7265657374722D706B692E72752F6364702F76677563312E63726C306E06082B0601050507010104623060302E06082B060105050730028622687474703A2F2F726F7374656C65636F6D2E72752F6364702F76677563312E637274302E06082B060105050730028622687474703A2F2F7265657374722D706B692E72752F6364702F76677563312E637274302B0603551D1004243022800F32303132303830393131343330305A810F32303133303830393131343330305A3082013506052A850364700482012A308201260C2D22D09AD180D0B8D0BFD182D0BED09FD180D0BE20435350222028D0B2D0B5D180D181D0B8D18F20332E362E31290C5322D0A3D0B4D0BED181D182D0BED0B2D0B5D180D18FD18ED189D0B8D0B920D186D0B5D0BDD182D1802022D09AD180D0B8D0BFD182D0BED09FD180D0BE20D0A3D0A62220D0B2D0B5D180D181D0B8D0B820312E350C4FD0A1D0B5D180D182D0B8D184D0B8D0BAD0B0D18220D181D0BED0BED182D0B2D0B5D182D181D182D0B2D0B8D18F20E2849620D0A1D0A42F3132312D3138363020D0BED1822031372E30362E323031320C4FD0A1D0B5D180D182D0B8D184D0B8D0BAD0B0D18220D181D0BED0BED182D0B2D0B5D182D181D182D0B2D0B8D18F20E2849620D0A1D0A42F3132382D3138323320D0BED1822030312E30362E32303132300806062A8503020203034100926BCC553A97465B8A60278D7B2363169D5938E8C041FF446382318838AAE2D585304E805FE970CFAC81571B3108E623E06F4E4C5CD1B30102493301ECC4E01C");
            var cert1 = new trusted.PKI.Certificate(der1);
            assertFalse(cert1.isSelfSigned());
        };
        CertificateTest.prototype.test_verify = function () {
            var der = Hex.toDer("308207C9308205B1A003020102020101300D06092A864886F70D0101050500307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F72697479301E170D3036303931373139343633365A170D3336303931373139343633365A307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F7269747930820222300D06092A864886F70D01010105000382020F003082020A0282020100C188DB09BC6C467C789F957BB53390F27262D6C1362022245ECEE977F2430AA20664A4CC8E36F838E623F06E6DB13CDD72A3851CA1D33DB4332BD32FAFFEEAB0415967B6C4067D0A9E7485D6794C80377ADF39055259F7F41B4643A4D28585D2C371F3756234BA2C8A7F1E8FEEED34D011C796CD523DBA33D6DD4DDE0B3B4A4B9FC2262FFAB5161C723577CA3C5DE6CAE1268B1A36765C01DB741425FEEDB5A0880FDD78CA2D1F079730012D7279FA46D6132AA8B9A6AB83491DE5F2EFDDE4018E180A8F6353168562A90E193ACCB566A6C26B7407E42BE1763EB46DD8F644E173621F3BC4BEA05356256C5109F7AAABCABF76FD6D9BF39DDBBF3D66BC0C56AAAF9848953A4BDFA75850D93875A95BEA430C02FF99EBE86C4D705B29659CDDAA5DCCAF0131EC0CEBD28DE8EA9C7BE66EF727660C1A48D76E42E33FDE213E7BE10D70FB63AAA86C1A54B45C257AC9A2C98B16A6BB2C7E175E054D586E121D01EE12100DC6327F18FFFCF4FACD6E91E83649BE1A48698BC2964D1A12B26917C10A90D6FA792248BFBA7B69F870C7FA7A37D8D80DD2764F57FF90B7E391D2DDEFC260B7673ADDFEAA9CF0D48B7F7222CEC69F97B6F8AF8AA010A8D9FB18C6B6B55C523C89B6192A73010A0F03B31260F27A2F81DBA36EFF263097F58BDD8957B6AD3DB3AF2BC5B77602F0A5D62B9A86142A72F6E3338C5D094B13DFBB8C7413524B0203010001A38202523082024E300C0603551D13040530030101FF300B0603551D0F0404030201AE301D0603551D0E041604144E0BEF1AA4405BA517698730CA346843D041AEF230640603551D1F045D305B302CA02AA0288626687474703A2F2F636572742E7374617274636F6D2E6F72672F73667363612D63726C2E63726C302BA029A0278625687474703A2F2F63726C2E7374617274636F6D2E6F72672F73667363612D63726C2E63726C3082015D0603551D2004820154308201503082014C060B2B0601040181B5370101013082013B302F06082B060105050702011623687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466303506082B060105050702011629687474703A2F2F636572742E7374617274636F6D2E6F72672F696E7465726D6564696174652E7064663081D006082B060105050702023081C330271620537461727420436F6D6D65726369616C20285374617274436F6D29204C74642E30030201011A81974C696D69746564204C696162696C6974792C2072656164207468652073656374696F6E202A4C6567616C204C696D69746174696F6E732A206F6620746865205374617274436F6D2043657274696669636174696F6E20417574686F7269747920506F6C69637920617661696C61626C6520617420687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466301106096086480186F8420101040403020007303806096086480186F842010D042B16295374617274436F6D20467265652053534C2043657274696669636174696F6E20417574686F72697479300D06092A864886F70D01010505000382020100166C99F4660C34F5D0855E7D0AECDA104E381C5EDFA625054B9132C1E83BF13DDD44095B07498A29CB6602B7B19AF72598093C8E1BE1DD36872B4BBB68D339663DA026C7F239911D51AB827B7ED5CE5AE4E2035770699708F95E58A60ADF8C069A451616380A5E57F662C77A0205E6BC1EB5F29EF4A92983F8B214E36E288744C3901ADE38A93CAC434D6445CEDD28A95CF2737B04F817E8ABB1F32E5C646E73313A12B8BCB311E47D8F81519A3B8D89F44D93667B3C03EDD39A1D9AF36550F5A0D0759F2FAFF0EA824398F8699C8979C4438E4672E3643612AFF7251E388990777EC36B6AB9C3CB444BAC78908BE7C72C1E4B1144C8345227CD0A5D9F85C189D51A78F295105332DD80846675D9B56828FB612EBE84A838C0991286A51E6764AD062E2FA97085C7960F7C8965F58E43540EABDDA580399460C034C996702CA312F51F487BBD1C7E6BB79D90F4223BAEF8FC2ACAFA8252A0EFAF4B5593EBC1B5F0228BAC344E262204A1872C754AB7E57D13D7B80C64C036D2C92F86128C2309C11B823B7349A36A578794E5D678C5994363E34DE0772DE165997269041A4709E60F015624FB1FBF0E79A9582EB9C409017E95BA6D00063EB2EA4A1039D8D02BF5BFEC75BF9702C5091B08DC5537E281FB3784436220CAE7564B65EAFE6CC1249324A134EB05FF9A22AE9B7D3FF165510AA6306AB3F4881C800DFC728AE8835E");
            var cert = new trusted.PKI.Certificate(der);
            var der1 = Hex.toDer("308202FB308201E302021223300D06092A864886F70D01010505003043310F300D06035504030C06636F6D6D6F6E310B3009060355040B0C026F75310A3008060355040A0C016F310A300806035504070C016C310B300906035504080C027374301E170D3134303931363035343430315A170D3135303931363035343430315A3043310F300D06035504030C06636F6D6D6F6E310B3009060355040B0C026F75310A3008060355040A0C016F310A300806035504070C016C310B300906035504080C02737430820122300D06092A864886F70D01010105000382010F003082010A0282010100AD256C7ABA585A6A463EF5E39C78FA44E3EF813DA0FED5B7919584248CA595ED09EEA9DBF3E16FB0F4DA8FD5C148B8537C236B7EBC2D07C61CDA6C8977F7D1E0BB1B28F96F4DE92B4F2B48EDC3B9F689BC26FCF8903221A6922E5BE6927CE00BAB0FBC3DED24C8DE06D0B4F191A62F3A4FB510693CEDCE746BF93B621504F0A7447AC616859FBDCACF08350B3DD33EC57150BE4E7EBCE527936EE2FF95A1AA960667E27D99812167F09A92B2E549660091CEC2293C8CF6A0ACB8471959F5B4919B3A02C1835972A1AFF38D0B0237396651BDEE83952733BFF1E8BCB9B33B3EEF5837086DC1A9ED8EC4A0E28BDB59096745A74A36DB958E5B0CA501CE753D439D0203010001300D06092A864886F70D010105050003820101005D0D626291DC8DF6BB152FBCA1F682A54B51624F4F32573D79924423D97256400D59BAB132EDD92134A0A6C01DBA384229DE155F71C78BF913D23D33F0956E401B76B45E70622ADE9AB15D0E101D70C15F1BEA7175EEBB32BA37F8972C55A13BBAA1D23838AF337976BC65BA58F0321491367E68029428D2ECF3CA721B87208C503DF8BC4AA550528B19A78BAC3916B5DD38220566AAB577F2381D66F9B64660F0CB24A035B78D8DB667C34669C472AF1B62443378AE2AE8180F62E7065F22EE50B6759AF98E8BDA399F40E8963605FA865011E531B48B8A327D8A046A7139A21852233079600076FA475D5C489F14B87C23C0982908025979D832163AF07DCD");
            var cert1 = new trusted.PKI.Certificate(der1);
            cert.verify(cert1).then(function (v) {
                if (!v)
                    console.error("test_verify: Должно быть TRUE, но пришло " + v);
                else
                    console.log(v);
            }, function (error) {
                console.error("test_verify: " + error);
            });
        };
        CertificateTest.prototype.test_Certificate_getHash = function () {
            var der = Hex.toDer("308207C9308205B1A003020102020101300D06092A864886F70D0101050500307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F72697479301E170D3036303931373139343633365A170D3336303931373139343633365A307D310B300906035504061302494C31163014060355040A130D5374617274436F6D204C74642E312B3029060355040B1322536563757265204469676974616C204365727469666963617465205369676E696E6731293027060355040313205374617274436F6D2043657274696669636174696F6E20417574686F7269747930820222300D06092A864886F70D01010105000382020F003082020A0282020100C188DB09BC6C467C789F957BB53390F27262D6C1362022245ECEE977F2430AA20664A4CC8E36F838E623F06E6DB13CDD72A3851CA1D33DB4332BD32FAFFEEAB0415967B6C4067D0A9E7485D6794C80377ADF39055259F7F41B4643A4D28585D2C371F3756234BA2C8A7F1E8FEEED34D011C796CD523DBA33D6DD4DDE0B3B4A4B9FC2262FFAB5161C723577CA3C5DE6CAE1268B1A36765C01DB741425FEEDB5A0880FDD78CA2D1F079730012D7279FA46D6132AA8B9A6AB83491DE5F2EFDDE4018E180A8F6353168562A90E193ACCB566A6C26B7407E42BE1763EB46DD8F644E173621F3BC4BEA05356256C5109F7AAABCABF76FD6D9BF39DDBBF3D66BC0C56AAAF9848953A4BDFA75850D93875A95BEA430C02FF99EBE86C4D705B29659CDDAA5DCCAF0131EC0CEBD28DE8EA9C7BE66EF727660C1A48D76E42E33FDE213E7BE10D70FB63AAA86C1A54B45C257AC9A2C98B16A6BB2C7E175E054D586E121D01EE12100DC6327F18FFFCF4FACD6E91E83649BE1A48698BC2964D1A12B26917C10A90D6FA792248BFBA7B69F870C7FA7A37D8D80DD2764F57FF90B7E391D2DDEFC260B7673ADDFEAA9CF0D48B7F7222CEC69F97B6F8AF8AA010A8D9FB18C6B6B55C523C89B6192A73010A0F03B31260F27A2F81DBA36EFF263097F58BDD8957B6AD3DB3AF2BC5B77602F0A5D62B9A86142A72F6E3338C5D094B13DFBB8C7413524B0203010001A38202523082024E300C0603551D13040530030101FF300B0603551D0F0404030201AE301D0603551D0E041604144E0BEF1AA4405BA517698730CA346843D041AEF230640603551D1F045D305B302CA02AA0288626687474703A2F2F636572742E7374617274636F6D2E6F72672F73667363612D63726C2E63726C302BA029A0278625687474703A2F2F63726C2E7374617274636F6D2E6F72672F73667363612D63726C2E63726C3082015D0603551D2004820154308201503082014C060B2B0601040181B5370101013082013B302F06082B060105050702011623687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466303506082B060105050702011629687474703A2F2F636572742E7374617274636F6D2E6F72672F696E7465726D6564696174652E7064663081D006082B060105050702023081C330271620537461727420436F6D6D65726369616C20285374617274436F6D29204C74642E30030201011A81974C696D69746564204C696162696C6974792C2072656164207468652073656374696F6E202A4C6567616C204C696D69746174696F6E732A206F6620746865205374617274436F6D2043657274696669636174696F6E20417574686F7269747920506F6C69637920617661696C61626C6520617420687474703A2F2F636572742E7374617274636F6D2E6F72672F706F6C6963792E706466301106096086480186F8420101040403020007303806096086480186F842010D042B16295374617274436F6D20467265652053534C2043657274696669636174696F6E20417574686F72697479300D06092A864886F70D01010505000382020100166C99F4660C34F5D0855E7D0AECDA104E381C5EDFA625054B9132C1E83BF13DDD44095B07498A29CB6602B7B19AF72598093C8E1BE1DD36872B4BBB68D339663DA026C7F239911D51AB827B7ED5CE5AE4E2035770699708F95E58A60ADF8C069A451616380A5E57F662C77A0205E6BC1EB5F29EF4A92983F8B214E36E288744C3901ADE38A93CAC434D6445CEDD28A95CF2737B04F817E8ABB1F32E5C646E73313A12B8BCB311E47D8F81519A3B8D89F44D93667B3C03EDD39A1D9AF36550F5A0D0759F2FAFF0EA824398F8699C8979C4438E4672E3643612AFF7251E388990777EC36B6AB9C3CB444BAC78908BE7C72C1E4B1144C8345227CD0A5D9F85C189D51A78F295105332DD80846675D9B56828FB612EBE84A838C0991286A51E6764AD062E2FA97085C7960F7C8965F58E43540EABDDA580399460C034C996702CA312F51F487BBD1C7E6BB79D90F4223BAEF8FC2ACAFA8252A0EFAF4B5593EBC1B5F0228BAC344E262204A1872C754AB7E57D13D7B80C64C036D2C92F86128C2309C11B823B7349A36A578794E5D678C5994363E34DE0772DE165997269041A4709E60F015624FB1FBF0E79A9582EB9C409017E95BA6D00063EB2EA4A1039D8D02BF5BFEC75BF9702C5091B08DC5537E281FB3784436220CAE7564B65EAFE6CC1249324A134EB05FF9A22AE9B7D3FF165510AA6306AB3F4881C800DFC728AE8835E");
            var cert = new trusted.PKI.Certificate(der);
            cert.getHash().then(function(result){
                if(!result)
                    console.error("getHash: что-то пошло не так!");
            },function(error){
                console.error("getHash ERROR: " + error);
            });
        };
    }
}