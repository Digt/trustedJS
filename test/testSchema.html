<!DOCTYPE html>
<html>
    <head>
        <title>ASN decoder</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <script src="../trustedJS.js"></script>
        <script src="../int10.js"></script>
        <script src="../asn1js/asn1.js"></script>
        <script src="../schemas/rfc5280.js"></script>
    </head>
    <body>
        <script>            
            var cert_hex = "308203F7308202DFA003020102020A470550C300000000002D300D06092A864886F70D01010505003066311E301C06092A864886F70D010901160F696E666F40747275737465642E7275310B3009060355040613025255311C301A060355040A1313436966726F766965205465686E6F6C6F676969311930170603550403131043542052534120546573742043412032301E170D3134303531323035333232355A170D3135303531323035343232355A301E310B3009060355040613025255310F300D0603550403130674657374303430819F300D06092A864886F70D010101050003818D0030818902818100A232F40D1CCBA895B8AE77E2832F5FB69E4B27120DE50CD015FDE227BA113B24475817EAA3F6E7A0D132DBC797F679F8913917D34826AB557ADBA7F9D37B9EECC08F700077B442C6A372AF6432889F35CA97ACC2C861E6A59F7BEC910B02E243C2E56D3B0F0F3D41C3B492101197EAD62D1A70173696268524614EFF9677B2670203010001A38201713082016D300E0603551D0F0101FF0404030203D8301D0603551D250416301406082B0601050507030206082B06010505070304301D0603551D0E04160414528842E4B23A4B6837519A665B91CB22A5F4E507301F0603551D23041830168014AF7F9323DA99CB130FF14005EB7D448E87EE5EB73081910603551D1F048189308186308183A08180A07E8641687474703A2F2F766D2D627374382E646967742E6C6F63616C2F43657274456E726F6C6C2F4354253230525341253230546573742532304341253230322E63726C863966696C653A2F2F564D2D425354382E646967742E6C6F63616C2F43657274456E726F6C6C2F435420525341205465737420434120322E63726C306806082B06010505070101045C305A305806082B06010505073002864C66696C653A2F2F564D2D425354382E646967742E6C6F63616C2F43657274456E726F6C6C2F564D2D425354382E646967742E6C6F63616C5F435420525341205465737420434120322E637274300D06092A864886F70D01010505000382010100340F5AC2E5A2D2CA190031E8EF7BB9F49578DA05B3A88A15A2D542B1A82CA2D7195DA12A171D616F510C08FAAC0BBCB848AC0FC0835A866BF97ADF77D9549C00CDC71D893CFD5E278836389E3CC0F31EE5042F220B669E33147ED6884CA10EE1918835695A9F28F7C47CAF6DA41B5C07506643FBF2642640F477B2FC2B1D51D1072287326BD4776F0DC3919FF607F960E9304F65584B70F6C39C35E7D9678F754CFD1F74D9C393A43E5A5EAE39E3FE27D48FF175CC4A8E25A82A3D046089B6F33E124C6501CA93F03EF186FB0C1BB249ED6A8185EC2385DC97030BB4C7EDCE68E51A8A0233CB8010762E65E69138298243108AEBEFF8BA8C22A8E25093A4D2E2";
            
            var obj = {
                data1: "0ab5",
                data2: {
                    data21: true,
                    data22: false
                },
                data3: false,
                data4: "000011",
                data5: "Hello world!!! Привет мир!!!",
                data6: [6, 1, 42],
                data7: "1.2.1.100.127.128.255.256",
                data8: "#2 Hello world!!!",
                data9: "#3 Hello world!!! Текcт на русском!!!",
                data10: new Date()
            };

            var asn = trusted.ASN.fromObject(obj, "Test");
            console.log(asn);
            
            asn.import(Hex.toDER(cert_hex));
            var cert = asn.toObject("Certificate");
            console.log(cert);
            asn.import(cert.tbsCertificate.extensions[3].extnValue);
            console.log(asn.toObject("AuthorityKeyIdentifier"));
            
        </script>
    </body>
</html>
